{"version":3,"sources":["app.js","detail.js","filters.js","footer.js","goback.js","header.js","home.js","message.js","publish.js","user.js"],"names":["baseWidth","root","document","documentElement","w","clientWidth","fz","style","fontSize","window","angular","module","controller","$scope","$location","showTDetail","id","path","search","topicID","config","$routeProvider","otherwise","run","$http","defaults","headers","post","Content-Type","when","templateUrl","html","collStu","status","content","get","then","res","data","is_collect","err","console","log","history","go","coll","accesstoken","topic_id","result","filter","$sce","text","trustAsHtml","directive","restrict","replace","scope","navs","tab","changeTab","nav","template","$element","$attrs","$transclude","goBack","title","$timeout","scroll","hasMore","getDatas","timeout","Object","prototype","toString","call","indexOf","lenth","topicList","concat","tabs","name","active","changeTopic","i","length","hasnot_read_messages","msg","newMsg","has_read_messages","oldMsg","pubSel","userMsg","collTopicList","uesTopiccal"],"mappings":"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","file":"app.min.js","sourcesContent":["'use strict';\r\n\r\n(function rem(baseWidth){\r\n    var root = document.documentElement;\r\n    var w = root.clientWidth;\r\n    w = w > 640 ? 640 : w < 320 ? 320 : w;\r\n    var fz = w / baseWidth * 100;\r\n    root.style.fontSize = fz + \"px\";\r\n}(414))\r\n\r\n// 加 window 避免 eslint 报错\r\nwindow.angular.module('myApp', [\r\n    'ngRoute',\r\n    'ngAnimate',\r\n    'infinite-scroll',\r\n    'myApp.start',\r\n    'myApp.msg',\r\n    'myApp.detail',\r\n    'myApp.filtes', // 所有的指令模块\r\n    'dir.footer',\r\n    'dir.header',\r\n    'dir.goback',\r\n    'myApp.publish',\r\n    'myApp.user'\r\n    // 'myApp.detail',\r\n    // 'myApp.order',\r\n    // 'myApp.orderList'\r\n  ])\r\n  .controller('parentCtrl',['$scope','$location',function($scope,$location){\r\n    // 查看topic 详情\r\n    $scope.showTDetail = function(id) {\r\n      // 转跳到详情页\r\n      $location.path('/detail').search({topicID: id});\r\n    }\r\n  }])\r\n  .config(['$routeProvider', function($routeProvider) {\r\n    $routeProvider.otherwise('/home');\r\n  }])\r\n\r\n  .run(['$http', function($http){\r\n    $http.defaults.headers.post = {'Content-Type' : 'application/json; charset=utf-8'};\r\n\r\n  }])\r\n","'use strict';\r\n\r\nwindow.angular.module('myApp.detail', ['ngRoute','ngAnimate'])\r\n  .config(['$routeProvider', function($routeProvider) {\r\n    $routeProvider\r\n      .when('/detail', {\r\n      templateUrl: 'tpl/detail.html',\r\n      controller: 'detailCtrl'\r\n    });\r\n  }])\r\n\r\n  .controller('detailCtrl', ['$scope', '$http', '$location', function($scope, $http, $location) {\r\n    $scope.html = '';\r\n    $scope.collStu={\r\n      status:\"\",\r\n      content:\"\"\r\n    };\r\n    // 获取 topic id 编号\r\n    var topicID = $location.search().topicID;\r\n    // 如果 有路由参数传过来，就请求数据，容错处理 if else\r\n    if (topicID) {\r\n      $http.get('https://cnodejs.org/api/v1/topic/' + topicID + '?mdrender=true'+'&accesstoken=32794b15-c1e8-4d80-8170-fdfb52d65a70')\r\n        .then(function(res) {\r\n          //判断主题是否被收藏\r\n          $scope.collStu.status= res.data.data.is_collect;\r\n          //如果被收藏就显示取消收藏  true 主题已经被收藏  false 主题没有收藏\r\n          if($scope.collStu.status==true){\r\n            $scope.collStu.content = '取消收藏'\r\n          }else {\r\n              $scope.collStu.content = '收藏'\r\n          }\r\n          $scope.html = res.data.data.content;\r\n        }, function(err) {\r\n          /* eslint-disable no-console*/\r\n          console.log(err);\r\n          /* eslint-enable no-console */\r\n        });\r\n\r\n    } else {\r\n      // 如果没有id ，就返回前一页\r\n      // 使用 浏览器 默认 返回  history.go(-1) , -1:表示后退一步\r\n      window.history.go(-1);\r\n    }\r\n    //收藏按钮的状态\r\n    //需要获取用户所收藏的主体与之进行判断。然后显示主体是否被收藏\r\n    $scope.coll = function(){\r\n      //收藏主题\r\n      if($scope.collStu.status==false){\r\n        $http.post('https://cnodejs.org/api/v1/topic_collect/collect',\r\n          {\r\n            accesstoken:\"32794b15-c1e8-4d80-8170-fdfb52d65a70\",\r\n            topic_id:topicID\r\n          }\r\n        )\r\n        .then(function(result){\r\n          console.log(result);\r\n          //收藏成功 ，改变按钮显示\r\n        //  if(result.data.success== true){\r\n            $scope.collStu.status = true;\r\n            $scope.collStu.content = '取消收藏'\r\n        //  }\r\n        },function(err){\r\n          console.log(err);\r\n        })\r\n      }else {//取消收藏\r\n        $http.post('https://cnodejs.org/api/v1/topic_collect/de_collect',\r\n          {\r\n            accesstoken:\"32794b15-c1e8-4d80-8170-fdfb52d65a70\",\r\n            topic_id:topicID\r\n          }\r\n        )\r\n        .then(function(result){\r\n          //console.log(result);\r\n        //  if(result.data.success == true){\r\n            $scope.collStu.status = false;\r\n            $scope.collStu.content='收藏'\r\n          //}\r\n        },function(err){\r\n          console.log(err);\r\n        })\r\n     }\r\n    }\r\n  }])\r\n","'use strict';\r\n\r\nwindow.angular.module('myApp.filtes', ['ngRoute','ngAnimate'])\r\n.filter('to_trusted', ['$sce', function ($sce) {\r\n  return function (text) {\r\n    return $sce.trustAsHtml(text);\r\n  };\r\n}]);\r\n","'use strict';\r\n\r\nwindow.angular.module('dir.footer', ['ngRoute', 'ngAnimate'])\r\n  .directive('ngFooter', ['$location', function($location) {\r\n    return {\r\n      restrict: 'AE',\r\n      replace: true,\r\n      scope: {},\r\n      templateUrl: './tpl/footer.html',\r\n      controller: ['$scope', function($scope) {\r\n        // 用于判断当前处于哪个 tab页，给对应的tab 导航键 加激活样式\r\n        $scope.path = $location.path();\r\n        // 导航\r\n        $scope.navs = [\r\n          { tab: 'home', path: '/home' },\r\n          { tab: 'msg', path: '/msg' },\r\n          { tab: 'publish', path: '/publish' },\r\n          { tab: 'user', path: '/user' }\r\n        ];\r\n        // 切换导航时，更换路由\r\n        $scope.changeTab = function (nav) {\r\n          $location.path(nav.path);\r\n        }\r\n\r\n      }]\r\n      // link: function ($scope, elm, attr, controller) {\r\n      //\r\n      // }\r\n    }\r\n  }])\r\n","'use strict';\r\n\r\nwindow.angular.module('dir.goback', ['ngRoute','ngAnimate'])\r\n  .directive('ngGoBack', [function() {\r\n    return {\r\n      restrict: 'AE',\r\n      scope: {},\r\n      replace: true,\r\n      template: '<div class=\"go-back\" ng-click=\"goBack()\">返回</div>',\r\n      // link: function ($scope, elm, attr, controller) {\r\n      // },\r\n      controller: ['$scope', '$element', '$attrs', '$transclude', function($scope, $element, $attrs, $transclude) {\r\n        $scope.goBack = function() {\r\n          window.history.go(-1);\r\n        }\r\n      }],\r\n    }\r\n  }])\r\n","'use strict';\r\n\r\nwindow.angular.module('dir.header', ['ngRoute','ngAnimate'])\r\n  .directive('ngHeader', ['$location',function($location) {\r\n    return {\r\n      restrict: 'E',\r\n      scope: {},\r\n      replace: true,\r\n      templateUrl: './tpl/header.html',\r\n      // link: function ($scope, elm, attr, controller) {\r\n      // }, , $element, $attrs, $transclude\r\n      controller: ['$scope', function($scope) {\r\n        $scope.title = 'header';\r\n        $scope.path = $location.path();\r\n        // 导航\r\n        // 切换导航时，更换路由\r\n      \r\n      }],\r\n    }\r\n  }])\r\n","'use strict';\r\n\r\n// 加 window 避免 eslint 报错\r\nwindow.angular.module('myApp.start', ['ngRoute','ngAnimate'])\r\n\r\n.config(['$routeProvider', function($routeProvider) {\r\n  $routeProvider.when('/home', {\r\n    templateUrl: 'tpl/home.html',\r\n    controller: 'homeCtrl'\r\n  });\r\n}])\r\n\r\n.controller('homeCtrl', ['$scope', '$http', '$timeout', '$location', function($scope, $http, $timeout, $location) {\r\n  $scope.scroll=false;\r\n  $scope.hasMore=true;\r\n\r\n  // 封装一个 获取后台数据的方法\r\n  $scope.getDatas= function(tab) { // tab用于切换不同tab时，\r\n    $scope.scroll=true;//禁止滚动执行事件\r\n    $http.get('https://cnodejs.org/api/v1/topics?page=1&tab=' + tab + '&limit=20', {\"timeout\": 3000})\r\n    .then(function(result) {\r\n      if(Object.prototype.toString.call(result).indexOf('Object')!=-1){\r\n        //没有更多内容\r\n        if(result.data.data.lenth<20){\r\n          $scope.hasMore=false;\r\n        }else {\r\n          $scope.scroll=false;\r\n        }\r\n        $scope.topicList = $scope.topicList.concat(result.data.data);\r\n      }else {\r\n        console.log('后台发送的topicList数据类型错误')\r\n      }\r\n    }, function(err){\r\n      /* eslint-disable no-console */\r\n      //console.log(err);\r\n      /* eslint-enable no-console */\r\n    });\r\n  }\r\n\r\n  // 初次请求 （此方法 并不太推荐使用，$timeout 跟settimeout一样，会等其他程序都跑完才会执行，可能会出现空白）\r\n  // $timeout(function () {\r\n  //   $scope.getDatas('');\r\n  // }, 0);\r\n\r\n  // 主题导航\r\n  $scope.tabs = [\r\n    { tab: '', name: '全部', active: true },\r\n    { tab: 'good', name: '精华', active: false },\r\n    { tab: 'share', name: '分享', active: false },\r\n    { tab: 'ask', name: '问答', active: false },\r\n    { tab: 'job', name: '招聘', active: false },\r\n  ];\r\n  // 切换导航方法\r\n  $scope.changeTopic = function(tab) {\r\n    //清除其他tab的active\r\n    for(var i=0 ; i<$scope.tabs.length ;i++){\r\n      if($scope.tabs[i]!=tab){\r\n        $scope.tabs[i].active=false;\r\n      }\r\n    }\r\n    tab.active=true;\r\n    //清空原有的数据\r\n    $scope.topicList = [];\r\n    //请求对应的tab数据\r\n    $scope.getDatas(tab.tab);\r\n  }\r\n  // topicList data\r\n  $scope.topicList = [];\r\n\r\n\r\n}])\r\n","'use strict';\r\n\r\nwindow.angular.module('myApp.msg', ['ngRoute','ngAnimate'])\r\n  .config(['$routeProvider', function($routeProvider) {\r\n    $routeProvider\r\n      .when('/msg', {\r\n      templateUrl: 'tpl/msg.html',\r\n      controller: 'msgCtrl'\r\n    });\r\n  }])\r\n\r\n  .controller('msgCtrl', ['$scope', '$http', '$timeout', function($scope, $http, $timeout) {\r\n\r\n    $http.get('https://cnodejs.org/api/v1/messages?&'+'accesstoken=32794b15-c1e8-4d80-8170-fdfb52d65a70'+'&mdrender=true')\r\n    .then(function(result){\r\n      //新消息\r\n      if(result.data.data.hasnot_read_messages.length==0){\r\n       $scope.msg=false;\r\n      }else {\r\n        $scope.msg=true;\r\n        $scope.newMsg=result.data.data.hasnot_read_messages;\r\n     }\r\n     //过往消息\r\n      if(result.data.data.has_read_messages.length==0){\r\n        $scope.oldMsg='无消息'\r\n      }\r\n    } , function(err){\r\n      console.log(err);\r\n    }\r\n  )\r\n  }])\r\n","'use strict';\r\n\r\nwindow.angular.module('myApp.publish', ['ngRoute', 'ngAnimate'])\r\n  .config(['$routeProvider' , function($routeProvider){\r\n    $routeProvider\r\n    .when('/publish', {\r\n      templateUrl: 'tpl/publish.html',\r\n      controller: 'publishCtrl'\r\n    });\r\n  }])\r\n\r\n  .controller('publishCtrl' , ['$scope' , '$http' , '$timeout',function($scope,$http,$timeout){\r\n    $scope.get=function(){\r\n      console.log($scope.pubSel);\r\n    }\r\n  }])\r\n","'use strict';\r\n\r\nwindow.angular.module('myApp.user', ['ngRoute', 'ngAnimate'])\r\n  .config(['$routeProvider' , function($routeProvider){\r\n    $routeProvider\r\n    .when('/user', {\r\n      templateUrl: 'tpl/user.html',\r\n      controller: 'userCtrl'\r\n    });\r\n  }])\r\n\r\n  .controller('userCtrl' , ['$scope' , '$http' , '$timeout',function($scope,$http,$timeout){\r\n    //获取用户详情\r\n    $http.get('https://cnodejs.org/api/v1/user/LwcReber')\r\n    .then(function(result){\r\n      $scope.userMsg=result.data.data;\r\n    },function(err){\r\n      console.log(err);\r\n    })\r\n     $scope.collTopicList=[];\r\n    //获取用户收藏的主题\r\n    $http.get('https://cnodejs.org/api/v1/topic_collect/LwcReber')\r\n    .then(function(result){\r\n      console.log(result);\r\n      $scope.uesTopiccal = result.data.data.length\r\n      $scope.collTopicList =$scope.collTopicList.concat(result.data.data);\r\n    },function(err){\r\n      console.log(err);\r\n    })\r\n  }])\r\n"]}